<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>TBC BIS Loots</title>
    <link rel="stylesheet" href="assets/style.css" />

    <script src="js/tooltip.js"></script>
    <script src="js/config.js"></script>
    <script src="js/filters.js"></script>
    <script src="js/dataLoader.js"></script>
    <script src="js/tableRenderer.js"></script>
    <script src="https://wow.zamimg.com/widgets/power.js"></script>
  </head>

  <body>
    <div id="app">
      <div class="credits-container">
        <div class="bmc-button">
          <a href="https://www.buymeacoffee.com/Tozz" target="_blank">
            <img
              src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&emoji=&slug=Tozz&button_colour=FFDD00&font_colour=000000&font_family=Cookie&outline_colour=000000&coffee_colour=ffffff" />
          </a>
        </div>
        <div class="credits-list">
          <p><span>Datamining :</span> Kerishai</p>
          <p><span>Ideas & Research :</span> Captp</p>
          <p><span>Conception :</span> Tozz</p>
        </div>
      </div>
      <div class="wide-row">
        <h1>TBC ‚Äì BIS Loots</h1>
        <p class="subtitle">
          Choisissez un raid, un boss, une classe et/ou un r√¥le pour afficher les loots. Survolez le nom pour voir le
          tooltip Wowhead.
        </p>

        <div id="filtersBar" class="filters-bar">
          <div class="controls">
            <div class="controls selector-block">
              <label for="raidSelect">Raid :</label>
              <select id="raidSelect"></select>
            </div>

            <div class="controls selector-block">
              <label for="bossSelect">Boss :</label>
              <select id="bossSelect">
                <option value="">Tous les boss</option>
              </select>
            </div>

            <div class="controls selector-block">
              <label for="slotSelect">Emplacement :</label>
              <select id="slotSelect">
                <option value="">Tous</option>
              </select>
            </div>

            <div class="controls selector-block">
              <label for="classSelect">Classe :</label>
              <select id="classSelect">
                <option value="">Toutes</option>
                <option value="Paladin">Paladin</option>
                <option value="Guerrier">Guerrier</option>
                <option value="Druide">Druide</option>
                <option value="Chaman">Chaman</option>
                <option value="Pr√™tre">Pr√™tre</option>
                <option value="Voleur">Voleur</option>
                <option value="Chasseur">Chasseur</option>
                <option value="Mage">Mage</option>
                <option value="D√©moniste">D√©moniste</option>
              </select>
            </div>

            <div class="controls selector-block">
              <label for="roleSelect">R√¥le :</label>
              <select id="roleSelect">
                <option value="">Tous</option>
                <option value="Tank">Tank</option>
                <option value="Heal">Heal</option>
                <option value="DPS">DPS</option>
              </select>
            </div>

            <div class="controls selector-block">
              <label for="bisFilter">BIS :</label>
              <select id="bisFilter">
                <option value="">Tous</option>
                <option value="BP1">BP1</option>
                <option value="BP2">BP2</option>
                <option value="BP3">BP3</option>
                <option value="BP4">BP4</option>
                <option value="BP5">BP5</option>
              </select>
            </div>
          </div>
        </div>

        <table>
          <thead>
            <tr>
              <th>Loot</th>
              <th>Emplacement</th>
              <th>Type</th>
              <th>Sp√© 1</th>
              <th>Sp√© 2</th>
              <th>Priorit√©</th>
              <th>BIS</th>
              <th>Token</th>
              <th>Notes</th>
            </tr>
          </thead>
          <tbody id="lootBody"></tbody>
        </table>
      </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", async () => {
        const raidSelect = document.getElementById("raidSelect");
        const bossSelect = document.getElementById("bossSelect");
        const bisFilter = document.getElementById("bisFilter");
        const slotSelect = document.getElementById("slotSelect");
        const classSelect = document.getElementById("classSelect");
        const roleSelect = document.getElementById("roleSelect");

        // Remplissage du select Raid
        RAID_GROUPS.forEach((g) => {
          const opt = document.createElement("option");
          opt.value = g.id;
          opt.textContent = g.label;
          raidSelect.appendChild(opt);
        });

        // Chargement des donn√©es
        await loadData();
        loadRaid(RAID_GROUPS[0].id);

        // Changement de raid
        raidSelect.addEventListener("change", () => {
          loadRaid(raidSelect.value);
        });

        // üî• Filtres DOM-d√©pendants (Boss / BIS)
        slotSelect.addEventListener("change", () => {
          requestAnimationFrame(renderTable);
        });

        classSelect.addEventListener("change", () => {
          requestAnimationFrame(renderTable);
        });

        roleSelect.addEventListener("change", () => {
          requestAnimationFrame(renderTable);
        });

        bossSelect.addEventListener("change", () => {
          requestAnimationFrame(() => {
            renderTable();
          });
        });

        bisFilter.addEventListener("change", () => {
          requestAnimationFrame(() => {
            renderTable();
          });
        });
      });
    </script>
  </body>
</html>
